from: fluidbyte/node:latest
services:
  - mongodb:
      from: mongo:latest
      volumes:
        - ${PWD}/data:/data/db
expose:
  - 9999:9999
env:
  - PORT=9999
  - AUTH_PASSWORD_SALT=ZV2YWOXF3YC70VIEQPVH
  - AUTH_JWT_SECRET=GFPNJJIFEDD2ECUGAD27
  - AUTH_JWT_EXPIRES=86400000
before: |
  export MONGODB_CONN=mongodb://$MONGODB_PORT_27017_TCP_ADDR/test
tasks:
  env: env | sort
  shell: /bin/bash
  clean: |
    rm -rf node_modules
    rm -rf client/jspm_packages
    rm -rf coverage
    rm -rf data
  clean:node_modules: rm -rf node_modules
  clean:jspm_packages: rm -rf jspm_packages
  clean:coverage: rm -rf coverage
  clean:data: rm -rf data
  start: |
    NODE_ENV=production
    yarn run start
  start:dev: yarn run dev
  upgrade: yarn upgrade --interactive
  install: yarn && jspm install
  lint: yarn run lint
  test: yarn run test
  test:watch: yarn run test:watch
